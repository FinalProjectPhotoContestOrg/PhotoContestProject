<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Create Contest</title>
    <link th:href="@{/css/bootstrap.css}" href="/static/css/bootstrap.css" rel="stylesheet">
</head>
<body>
<nav th:replace="~{ForumForms.html :: navbar}"></nav>

<div class="container mt-5">
    <h2>Create a New Contest</h2>

    <!-- Form to create a new contest -->
    <form th:action="@{/contests/create}" method="post" th:object="${contest}" enctype="multipart/form-data">

        <!-- Contest Title -->
        <div class="form-group">
            <label for="title">Title:</label>
            <input type="text" class="form-control" id="title" name="title" th:value="${contest.title}" required>
        </div>

        <!-- Contest Category -->
        <div class="form-group">
            <label for="category">Category:</label>
            <input type="text" class="form-control" id="category" name="category" th:value="${contest.category}" required>
        </div>

        <!-- Contest Type (Open or Invitational) -->
        <div class="form-group">
            <label for="contestType">Contest Type:</label>
            <select class="form-control" id="contestType" name="contestType" required>
                <option th:each="type : ${T(com.example.photocontestproject.enums.ContestType).values()}"
                        th:value="${type.name()}"
                th:text="${type}"></option>
            </select>
        </div>

        <!-- Phase 1 End Date -->
        <div class="form-group">
            <label for="phase1End">Phase 1 End Date:</label>
            <input type="datetime-local" class="form-control" id="phase1End" name="phase1End" th:value="${contest.phase1End}" required>
        </div>

        <!-- Phase 2 End Date -->
        <div class="form-group">
            <label for="phase2End">Phase 2 End Date:</label>
            <input type="datetime-local" class="form-control" id="phase2End" name="phase2End" th:value="${contest.phase2End}" required>
        </div>

        <!-- Cover Photo Upload -->
        <div class="form-group" style="margin: 10px">
            <label for="coverPhoto">Cover Photo (3MB limit):</label>
            <input type="file" class="form-control-file" id="coverPhoto" name="coverPhoto" accept="image/*" required>
        </div>

        <!-- Juror Selection -->
        <div class="mb-3">
            <label for="jurors" class="form-label">Select Jurors</label>
            <select id="jurors" name="jurorIds" class="form-select" multiple>
                <option th:each="juror : ${masters}" th:value="${juror.id}" th:text="${juror.firstName + ' ' + juror.lastName}"></option>
            </select>
        </div>

        <!-- Invitational Participant Selection (hidden initially) -->
        <div id="participantBlock" class="mb-3" style="display: none;">
            <label for="participants" class="form-label">Select Participants (for invitational contest)</label>
            <select id="participants" name="participantIds" class="form-select" multiple>
                <option th:each="junkie : ${junkies}" th:value="${junkie.id}" th:text="${junkie.firstName + ' ' + junkie.lastName}"></option>
            </select>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary">Create Contest</button>
    </form>

    <div style="height: 350px"></div>
</div>

<footer th:replace="~{ForumForms.html :: footer}"></footer>

<!-- JavaScript to handle contest type change -->
<script>
    document.getElementById('contestType').addEventListener('change', function() {
        const participantBlock = document.getElementById('participantBlock');
        const contestType = this.value;

        // Show participant selection if the contest is invitational
        if (contestType === 'Invitational') {
            participantBlock.style.display = 'block';
        } else {
            participantBlock.style.display = 'none';
        }
    });
</script>

<script src="/js/scripts.js"></script>
</body>
</html>
